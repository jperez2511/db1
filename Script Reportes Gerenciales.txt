--VISTA 1
CREATE OR REPLACE VIEW PEDIDOS_PENDIENTES AS
SELECT 
  IDPEDIDO,
  FECHAPEDIDO
FROM PEDIDOPROVEEDOR
WHERE CATESTADOPEDIDO_IDESTADO=0;

--VISTA 2
CREATE OR REPLACE VIEW PROVEEDOR_POR_DEPARTEMENTO AS
SELECT 
  A.NOMBREPROVEEDOR,
  C.DESCRIPCIONDEPARTAMENTO
FROM PROVEEDOR A
INNER JOIN DIRECCIONPROVEEDOR B ON A.IDPROVEEDOR=B.PROVEEDOR_IDPROVEEDOR 
INNER JOIN DEPARTAMENTO C ON B.CATDEPTO_IDDEPTO=C.IDDEPARTAMENTO;

--VISTA 3
CREATE OR REPLACE VIEW PEDIDOS_POR_PROVEEDOR AS
SELECT 
  A.NOMBREPROVEEDOR,
  B.IDPEDIDO,
  B.FECHAPEDIDO
FROM PROVEEDOR A
INNER JOIN PEDIDOPROVEEDOR B ON A.IDPROVEEDOR=C.IDPROVEEDOR;

--VISTA 4
CREATE OR REPLACE VIEW PRODUCTOS_POR_MARCA AS
SELECT 
  A.NOMBREPRODUCO,
  C.NOMBREMARCA
FROM PRODUCTO A
INNER JOIN MARCAPRODUCTO B ON A.IDPRODUCTO=B.IDPRODUCTO
INNER JOIN MARCA C ON B.IDMARCA=C.IDMARCA;

--VISTA 5
CREATE OR REPLACE VIEW PRODUCTOS_POR_CATEGORIA AS
SELECT 
  A.NOMBREPRODUCO,
  B.DESCRIPCIONCATEGORIA
FROM PRODUCTO A
INNER JOIN CATEGORIA B ON A.CATEGORIA_IDCATEGORIA=B.IDCAT;

--VISTA 6
CREATE OR REPLACE VIEW PRODUCTO_MAS_VALIOSO_POR_MARCA AS
SELECT 
  A.NOMBREPRODUCO,
  C.NOMBREMARCA,
  MAX(A.PRECIO) AS PRECIOMAXIMO
FROM PRODUCTO A
INNER JOIN MARCAPRODUCTO B ON A.IDPRODUCTO=B.IDPRODUCTO
INNER JOIN MARCA C ON B.IDMARCA=C.IDMARCA
GROUP BY A.NOMBREPRODUCO,C.NOMBREMARCA;

--VISTA 7
CREATE OR REPLACE VIEW PRODUCTOS_MAS_VALIOSO_POR_CATEGORIA AS
SELECT 
  A.NOMBREPRODUCO,
  B.DESCRIPCIONCATEGORIA,
  MAX(A.PRECIO) AS PRECIOMAXIMO
FROM PRODUCTO A
INNER JOIN CATEGORIA B ON A.CATEGORIA_IDCATEGORIA=B.IDCAT
GROUP BY A.NOMBREPRODUCO,B.DESCRIPCIONCATEGORIA; 

--VISTA 8
CREATE OR REPLACE VIEW PEDIDOS_DEL_MES AS
SELECT 
  IDPEDIDO,
  FECHAPEDIDO
FROM PEDIDOPROVEEDOR
WHERE FECHAPEDIDO BETWEEN '01/10/2019' AND '31/10/2019'; 

--VISTA 9
CREATE OR REPLACE VIEW ULTIMO_PEDIDO_POR_PROVEEDOR AS
SELECT 
  A.IDPEDIDO,
  MAX(A.FECHAPEDIDO) AS FECHAMAXIMA,
  B.NOMBREPROVEEDOR
FROM PEDIDOPROVEEDOR A
INNER JOIN PROVEEDOR B ON A.PROVEEDOR_IDPROVEEDOR=B.IDPROVEEDOR
GROUP BY B.NOMBREPROVEEDOR,A.IDPEDIDO;

--VISTA 10
CREATE OR REPLACE VIEW UNIDADES_POR_PEDIDO AS
SELECT 
  B.IDPEDIDO,
  SUM(A.UNIDADES) AS CANTIDADTOTAL
FROM LINEAPEDIDO A
INNER JOIN PEDIDOPROVEEDOR B ON A.PEDIDOPROVEEDOR_IDPEDIDO=B.IDPEDIDO
GROUP BY B.IDPEDIDO;